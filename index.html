<!doctype html>
<html lang="en"> 
 <head> 
  <meta charset="UTF-8"> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <title>Funpage Sports and Safaris: Adventure, Training &amp; Events</title> 
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&amp;family=Roboto:wght@400;700&amp;display=swap" rel="stylesheet">
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"> 
  <style>
        /* --- Global Styles & Variables --- */
        /* Removed @import url() for fonts - now using <link> tags above */
        
        :root {
            --color-primary: #0056b3; 
            --color-secondary: #dc3545; 
            --color-dark: #1a1a1a; 
            --color-light: #f8f9fa; 
            --color-maroon: #800000; 
            --color-accent-orange: #ff4500; 
            --color-mid-gray: #4a4a4a;
        }
        
        body {
            margin: 0;
            font-family: 'Roboto', sans-serif;
            background-color: var(--color-light);
            color: var(--color-dark);
            line-height: 1.6;
            scroll-behavior: smooth;
        }

        /* Utility Class for Active Link */
        .active-link {
            color: var(--color-accent-orange) !important;
            border-bottom: 2px solid var(--color-accent-orange);
            padding-bottom: 5px;
        }

        h2 {
            font-family: 'Poppins', sans-serif;
            font-size: 2.5rem;
            color: var(--color-dark);
            text-align: center;
            margin-bottom: 40px;
            padding-top: 20px;
        }

        h2 span {
            color: var(--color-primary); 
        }

        section {
            padding: 80px 5%; 
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* --- Animations --- */
        @keyframes fadeInUp {
            0% { opacity: 0; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        @keyframes scaleIn {
            0% { opacity: 0; transform: scale(0.9); }
            100% { opacity: 1; transform: scale(1); }
        }

        @keyframes headerFadeIn {
            0% { opacity: 0; transform: translateY(-100%);}
            100% { opacity: 1; transform: translateY(0);}
        }

        /* NEW: Utility class for animated sections */
        .animate-on-scroll {
            opacity: 0;
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
            transform: translateY(40px);
        }

        .animate-on-scroll.is-visible {
            opacity: 1;
            transform: translateY(0);
        }


        /* --- 1. Sticky, Transparent Header (Revised for Dropdown) --- */
        .header {
            position: fixed; 
            top: 0;
            left: 0;
            width: 100%;
            z-index: 20;
            background: rgba(0, 0, 0, 0.85); 
            font-family: 'Poppins', sans-serif;
            transition: background-color 0.3s;
            animation: headerFadeIn 0.8s ease-out forwards; 
            padding: 10px 5%; 
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-nav {
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        /* Logo/Home link styling */
        .header-nav .logo-link, .header a.logo-link {
            font-size: 1.5rem;
            font-weight: 800;
            margin-right: 40px; 
            color: var(--color-light) !important;
            border-bottom: none !important;
        }
        
        .header-nav .logo-link:hover, .header a.logo-link:hover {
             color: var(--color-accent-orange) !important;
        }

        .header-nav a {
            color: var(--color-light);
            text-decoration: none;
            margin: 0 15px;
            font-weight: 600;
            transition: color 0.3s, border-bottom 0.3s;
            padding: 10px 0;
        }

        .header-nav a:hover {
            color: var(--color-accent-orange); 
        }

        /* Hamburger Icon (Desktop: Hidden) */
        .menu-toggle {
            display: none;
            font-size: 1.8rem;
            color: var(--color-light);
            cursor: pointer;
        }
        
        /* --- 2. Enhanced Hero Section --- */
        .hero {
            position: relative;
            height: 65vh; 
            overflow: hidden; 
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            background-color: var(--color-dark); 
            color: var(--color-light);
        }

        .hero-background-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://i.postimg.cc/8kLRm48Z/IMG-20251013-WA0010.jpg') no-repeat center center/cover;
            background-position: center; 
            z-index: 1;
            background-attachment: fixed; 
        }

        .hero-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.75); 
            z-index: 2;
        }

        /* Hero Content Animations */
        .hero-content {
            position: relative;
            z-index: 10; 
            color: var(--color-light);
            max-width: 900px; 
            padding: 40px;
            background: rgba(0, 0, 0, 0.5); 
            border-radius: 15px;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.5);
            transform: perspective(1000px); 
        }
        
        .hero-content h1 {
            font-family: 'Poppins', sans-serif;
            font-size: 4.2rem; 
            margin-bottom: 0.4rem;
            color: var(--color-light); 
            font-weight: 800;
            text-transform: uppercase;
            opacity: 0; 
            animation: fadeInUp 1s ease-out forwards; 
            animation-delay: 1s; 
        }
        
        .hero-content .tagline {
            font-size: 1.9rem; 
            font-family: 'Poppins', sans-serif;
            margin-top: 0;
            margin-bottom: 2.5rem; 
            font-weight: 600;
            color: var(--color-accent-orange); 
            opacity: 0; 
            animation: fadeInUp 1s ease-out forwards; 
            animation-delay: 1.5s; 
        }
        
        .cta-group {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }

        .cta-button {
            display: inline-block;
            padding: 18px 35px;
            background-color: var(--color-primary); 
            color: var(--color-light);
            text-decoration: none;
            font-family: 'Poppins', sans-serif;
            font-size: 1.1rem;
            font-weight: 700;
            border-radius: 50px;
            border: 3px solid var(--color-primary);
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px rgba(0, 86, 179, 0.6); 
            opacity: 0; 
            animation: scaleIn 0.8s ease-out forwards;
        }

        .cta-button:nth-child(1) { animation-delay: 2s; } 
        .cta-button:nth-child(2) { 
            animation-delay: 2.3s; 
            background-color: var(--color-secondary); 
            border-color: var(--color-secondary);
            box-shadow: 0 5px 20px rgba(220, 53, 69, 0.6);
        }

        .cta-button:hover {
            transform: scale(1.05) translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 86, 179, 0.8);
            background-color: var(--color-primary);
            border-color: var(--color-primary);
        }
        .cta-button:nth-child(2):hover {
            box-shadow: 0 8px 25px rgba(220, 53, 69, 0.8);
            background-color: var(--color-accent-orange);
            border-color: var(--color-accent-orange);
        }

        /* --- 3. Interactive Services Grid --- */
        .services {
            background-color: var(--color-light);
            padding-top: 60px; 
            padding-bottom: 60px; 
        }

        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 40px; 
            padding-top: 20px; 
        }

        .service-card {
            background-color: white;
            padding: 25px; 
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s;
            border-bottom: 5px solid var(--color-secondary); 
            cursor: pointer; 
        }

        .service-card:hover {
            transform: translateY(-10px) scale(1.02); 
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.25);
            border-bottom-color: var(--color-primary); 
        }

        .service-card i {
            font-size: 2.6rem; 
            color: var(--color-primary); 
            margin-bottom: 10px; 
            transition: color 0.3s;
        }
        
        .service-card:hover i {
            color: var(--color-secondary); 
        }

        .service-card a {
            pointer-events: all; 
            text-decoration: none;
            font-weight: 600;
            color: var(--color-primary);
            transition: color 0.3s;
        }

        .service-card a:hover {
            color: var(--color-accent-orange);
        }

        /* --- Testimonial Slideshow Styling --- */
        .testimonials {
            background-color: var(--color-light); 
            padding-top: 60px;
            padding-bottom: 60px;
        }

        .testimonial-slideshow {
            position: relative;
            max-width: 800px;
            margin: auto;
            overflow: hidden;
            border-radius: 10px;
            background-color: #ffffff;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        }

        .testimonial-slide {
            padding: 40px;
            text-align: center;
            display: none; 
            animation: fadeInUp 0.5s ease-out;
        }
        
        .testimonial-slide.active-slide {
            display: block;
        }

        .testimonial-text {
            font-style: italic;
            font-size: 1.1rem;
            color: var(--color-mid-gray);
            margin-bottom: 25px;
            position: relative;
        }
        
        .testimonial-text::before {
            content: "\f10d"; 
            font-family: "Font Awesome 6 Free";
            font-weight: 900;
            color: var(--color-primary);
            font-size: 2rem;
            position: absolute;
            left: 50%;
            transform: translateX(-50%) translateY(-20px);
            opacity: 0.2;
        }

        .testimonial-author {
            font-weight: 700;
            color: var(--color-dark);
            font-size: 1.2rem;
            margin-bottom: 5px;
        }

        .testimonial-role {
            font-weight: 400;
            color: var(--color-accent-orange);
            font-size: 0.9rem;
        }
        
        /* Dots for navigation */
        .slideshow-dots {
            text-align: center;
            padding: 20px 0;
            background-color: #f1f1f1;
            border-top: 1px solid #ddd;
        }

        .dot {
            height: 12px;
            width: 12px;
            margin: 0 5px;
            background-color: #bbb;
            border-radius: 50%;
            display: inline-block;
            transition: background-color 0.6s ease;
            cursor: pointer;
        }

        .dot.active-dot {
            background-color: var(--color-primary);
        }


        /* --- About Us --- */
        .about-us {
            background-color: var(--color-maroon); 
            color: var(--color-light); 
            clip-path: polygon(0 15%, 100% 0, 100% 100%, 0% 100%); 
            margin-top: -100px; 
            padding-top: 150px; 
            padding-bottom: 100px; 
        }
        
        .about-content {
            display: flex;
            align-items: center;
            gap: 60px; 
        }

        .about-text {
            flex: 2;
            text-align: left;
        }
        
        .about-image-box {
            flex: 1;
            background: #ffffff; 
            border: 2px solid var(--color-accent-orange);
            height: 350px;
            border-radius: 10px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
            background-attachment: fixed; 
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: 700;
        }

        .about-image-box i {
            font-size: 6rem;
            color: var(--color-primary);
        }
        
        /* --- Modal and Footer Styling (unchanged) --- */
        .modal {
            display: none; 
            position: fixed; 
            z-index: 50; 
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto; 
            background-color: rgba(0,0,0,0.7); 
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: var(--color-light);
            margin: auto;
            padding: 30px;
            border-radius: 10px;
            width: 80%;
            max-width: 600px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            animation: scaleIn 0.3s ease-out;
            position: relative;
        }

        .close-button {
            color: var(--color-dark);
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            position: absolute;
            top: 10px;
            right: 20px;
        }
        
        footer {
            background-color: var(--color-dark);
            color: var(--color-light); 
            text-align: center;
            padding: 30px 20px;
            font-size: 0.9rem;
            border-top: none;
            background-image: none;
        }

        .social-icons {
            margin-bottom: 15px;
        }
        
        .social-icons a {
            color: var(--color-light);
            font-size: 1.5rem;
            margin: 0 12px;
            transition: color 0.3s;
        }

        .social-icons a:hover {
            color: var(--color-accent-orange); 
        }


        /* --- Mobile Responsiveness FIXES (Updated for Dropdown) --- */
        @media (max-width: 768px) {
            
            /* Show Hamburger icon and hide desktop menu */
            .header {
                justify-content: space-between;
                padding: 10px 5%;
            }
            .header-nav {
                display: none; /* Hide desktop navigation links */
                flex-direction: column;
                position: absolute;
                top: 60px; /* Below the header */
                left: 0;
                width: 100%;
                background: rgba(0, 0, 0, 0.95);
                text-align: center;
                border-top: 1px solid var(--color-accent-orange);
            }
            .header-nav.open {
                display: flex; /* Show when 'open' class is added by JS */
            }
            .header-nav a {
                margin: 0;
                padding: 15px 0;
                width: 100%;
                border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            }
            .header-nav a.logo-link {
                display: none; /* Hide logo link in the dropdown menu */
            }

            .menu-toggle {
                display: block; /* Show hamburger icon */
            }

            /* Rest of Mobile Fixes */
            .hero {
                height: 55vh; 
            }
            .hero-content h1 {
                font-size: 2.5rem; 
            }
            .hero-content .tagline {
                font-size: 1.3rem; 
            }
            .cta-group {
                flex-direction: column;
                gap: 15px;
            }
            .about-content {
                flex-direction: column; 
                gap: 30px; 
            }
            .about-image-box {
                height: 250px;
                width: 100%;
                background-attachment: scroll; 
            }
            .testimonial-slide {
                padding: 20px;
            }
        }
    </style> 
 </head> 
  <body> 
  <div id="serviceModal" class="modal" onclick="closeModal(event)"> 
   <div class="modal-content"> <span class="close-button" onclick="closeModal(event)">×</span> 
    <h3 id="modalTitle" style="color: var(--color-primary); font-size: 1.8rem;"></h3> 
    <p id="modalBody"></p> 
    <p style="margin-top: 20px; font-weight: 600;">Ready to book this adventure?</p> <a href="booking.html" class="cta-button" style="background-color: var(--color-secondary); margin-top: 10px;">Book This Service Now</a> 
   </div> 
  </div> 
  <header class="header"> <a href="#hero" id="link-hero" class="logo-link">FUNPAGE</a> 
   <nav class="header-nav" id="mainNav"> <a href="#hero">Home</a> <a href="#services" id="link-services">Services</a> <a href="#testimonials" id="link-testimonials">Testimonials</a> <a href="#about" id="link-about">About Us</a> <a href="#">Gallery</a> <a href="#">Contact</a> 
   </nav> 
   <div class="menu-toggle" id="menuToggle"> <i class="fas fa-bars"></i> 
   </div> 
  </header> 
  <section class="hero" id="hero"> 
   <div class="hero-background-image"></div> 
   <div class="hero-overlay"></div> 
   <div class="hero-content"> 
    <h1>FUNPAGE SPORTS AND SAFARIS</h1> 
    <p class="tagline">Adventure, Professional Training, and Dynamic Event Management.</p> 
    <div class="cta-group"> <a href="#services" class="cta-button">EXPLORE SERVICES</a> <a href="booking.html" class="cta-button">BOOK NOW</a> 
    </div> 
   </div> 
  </section> 
    <section class="services animate-on-scroll" id="services"> 
   <div class="container"> 
    <h2>Our <span>Four Pillars</span> of Adventure &amp; Growth</h2> 
    <div class="services-grid"> 
     <div class="service-card" data-service="Professional Swimming Lessons" data-details="Our certified instructors provide tailored lessons focusing on water safety, confidence building, and stroke mastery for all ages. Packages available from beginner to advanced training."> <i class="fas fa-swimmer"></i> 
      <h3>Professional Swimming Lessons</h3> 
      <p>Building water safety and confidence with highly certified instructors. Lessons are structured for efficient learning and rapid progress.</p> <a href="booking.html">More Details &amp; Booking <i class="fas fa-arrow-right"></i></a> 
     </div> 
     <div class="service-card" data-service="Outdoor Trips &amp; Safaris" data-details="We handle all logistics for unforgettable safaris, mountain hikes, and beach trips. Perfect for staff retreats, school outings, or family adventures. Focus is on safety and seamless execution."> <i class="fas fa-mountain"></i> 
      <h3>Outdoor Trips &amp; Safaris</h3> 
      <p>Fully managed adventures for families, staff, and schools. Explore natural beauty and create unforgettable memories with zero logistics stress.</p> <a href="booking.html">More Details &amp; Booking <i class="fas fa-arrow-right"></i></a> 
     </div> 
     <div class="service-card" data-service="Team Building &amp; Cohesion" data-details="High-impact corporate and school programs designed to enhance communication, leadership, and collaboration. Our activities are engaging, challenging, and yield measurable results in team performance."> <i class="fas fa-users-line"></i> 
      <h3>Team Building &amp; Cohesion</h3> 
      <p>Dynamic programs designed to break down barriers, enhance communication, and foster strong leadership within your staff or school teams.</p> <a href="booking.html">More Details &amp; Booking <i class="fas fa-arrow-right"></i></a> 
     </div> 
     <div class="service-card" data-service="Sports &amp; Event Management" data-details="Expert organization of tournaments, fun days, and sports events. We manage everything from venue and permits to participant registration and vendor coordination, ensuring a successful and engaging event."> <i class="fas fa-calendar-check"></i> 
      <h3>Sports &amp; Event Management</h3> 
      <p>Expert organization and facilitation of outdoor sports and related events, ensuring professional execution and maximum participation fun.</p> <a href="booking.html">More Details &amp; Booking <i class="fas fa-arrow-right"></i></a> 
     </div> 
    </div> 
   </div> 
  </section> 
  <section class="testimonials animate-on-scroll" id="testimonials"> 
   <div class="container"> 
    <h2>Hear It From Our <span>Clients</span></h2> 
    <div class="testimonial-slideshow"> 
     <div class="testimonial-slide active-slide"> 
      <p class="testimonial-text">"The corporate team-building event was perfectly organized and incredibly effective. Our staff morale and communication have seen a noticeable improvement. Highly recommend Funpage for professional event management!"</p> 
      <p class="testimonial-author">Sarah Wanjiku</p> 
      <p class="testimonial-role">HR Manager, Horizon Finance</p> 
     </div> 
     <div class="testimonial-slide"> 
      <p class="testimonial-text">"My son, Kevin, learned to swim safely and confidently in just one package of lessons. The instructor was patient, certified, and made the whole experience fun. A truly valuable life skill acquired."</p> 
      <p class="testimonial-author">Mercy Adhiambo</p> 
      <p class="testimonial-role">Satisfied Parent, Nairobi</p> 
     </div> 
     <div class="testimonial-slide"> 
      <p class="testimonial-text">"Our school's recent educational safari trip was seamless from start to finish. Funpage handled all the logistics, allowing the teachers and students to focus entirely on the experience. A five-star service!"</p> 
      <p class="testimonial-author">Mr. Ben Kipkorir</p> 
      <p class="testimonial-role">Principal, Rift Valley Academy</p> 
     </div> 
     <div class="slideshow-dots" id="slideshowDots"> 
     </div> 
    </div> 
   </div> 
  </section> 
    <section class="about-us animate-on-scroll" id="about"> 
   <div class="container"> 
    <h2 style="color: var(--color-light);">About <span>Funpage</span></h2> 
    <div class="about-content"> 
     <div class="about-text"> 
      <p> Since our founding, Funpage Sports and Safaris has been dedicated to merging high-quality professional instruction with exhilarating outdoor experiences. Our ethos is simple: **Efficiency meets Adventure**. </p> 
      <p> We understand that whether you're learning a life skill like swimming, planning a crucial school trip, or investing in staff team cohesion, you require professionalism, safety, and measurable results. That's what we deliver. Our team consists of certified instructors, experienced guides, and expert event planners, all committed to making your experience seamless and highly impactful. </p> 
      <p> Our Mission: To empower individuals and teams through expert instruction and unforgettable outdoor exploration. </p> 
     </div> 
     <div class="about-image-box"> <i class="fas fa-helmet-safety"></i> 
     </div> 
    </div> 
   </div> 
  </section> 
  <footer> 
   <div class="social-icons"> <a href="#" aria-label="Follow us on Facebook"><i class="fab fa-facebook-f"></i></a> <a href="#" aria-label="Follow us on Instagram"><i class="fab fa-instagram"></i></a> <a href="#" aria-label="Chat with us on WhatsApp"><i class="fab fa-whatsapp"></i></a> 
   </div> © 2025 Funpage Sports and Safaris. All rights reserved. | <a href="mailto:info@funpage.com">info@funpage.com</a> | <a href="tel:+254791566724">+254 791 566 724</a> 
  </footer> 
  <script>
        // --- Modal Functionality ---
        const modal = document.getElementById('serviceModal');
        const modalTitle = document.getElementById('modalTitle');
        const modalBody = document.getElementById('modalBody');
        const serviceCards = document.querySelectorAll('.service-card');
        const navLinks = document.querySelectorAll('.header-nav a'); // All nav links
        const menuToggle = document.getElementById('menuToggle');
        const mainNav = document.getElementById('mainNav');

        serviceCards.forEach(card => {
            card.addEventListener('click', function() {
                // The modal click logic is now simplified since the card click no longer directly opens the booking page
                // We keep the modal to show the details, and the button *inside* the modal goes to booking.html
                modalTitle.textContent = this.getAttribute('data-service');
                modalBody.textContent = this.getAttribute('data-details');
                modal.style.display = 'flex';
            });
        });

        function closeModal(event) {
            // Check if the click was on the modal background or the close button
            if (event.target === modal || event.target.className === 'close-button') {
                modal.style.display = 'none';
            }
        }
        
        // --- Mobile Dropdown Toggle ---
        menuToggle.addEventListener('click', () => {
            mainNav.classList.toggle('open');
            // Change hamburger icon to close icon
            menuToggle.querySelector('i').classList.toggle('fa-bars');
            menuToggle.querySelector('i').classList.toggle('fa-times');
        });

        // Close dropdown when a link is clicked (on mobile)
        navLinks.forEach(link => {
            link.addEventListener('click', () => {
                if (mainNav.classList.contains('open')) {
                    mainNav.classList.remove('open');
                    menuToggle.querySelector('i').classList.add('fa-bars');
                    menuToggle.querySelector('i').classList.remove('fa-times');
                }
            });
        });

        // --- Active Link Highlight & Scroll Spy ---
        const sections = document.querySelectorAll('section');

        window.addEventListener('scroll', () => {
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                // Adjust for header height and a small offset
                if (pageYOffset >= sectionTop - 150) { 
                    current = section.getAttribute('id');
                }
            });

            // Re-select links including the logo/home link for consistency
            document.querySelectorAll('.header a').forEach(link => {
                link.classList.remove('active-link');
                // Ensure the link's href is not just '#' for contact/gallery
                if (link.href.includes(current) && current !== '') {
                    link.classList.add('active-link');
                } else if (current === 'hero' && link.href.includes('#hero')) {
                    // Specific case for the hero section
                    link.classList.add('active-link');
                }
            });
        });

        // Set initial active link (Hero)
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('link-hero').classList.add('active-link');
            setupSlideshow();
            setupScrollAnimations(); // NEW: Call the scroll animation setup
        });


        // --- Testimonial Slideshow Functionality ---
        let slideIndex = 0;
        let slideInterval;

        function showSlides(n) {
            const slides = document.getElementsByClassName("testimonial-slide");
            const dots = document.getElementsByClassName("dot");
            
            if (n >= slides.length) { slideIndex = 0 }    
            if (n < 0) { slideIndex = slides.length - 1 }

            for (let i = 0; i < slides.length; i++) {
                slides[i].classList.remove('active-slide');
            }
            for (let i = 0; i < dots.length; i++) {
                dots[i].classList.remove('active-dot');
            }

            slides[slideIndex].classList.add('active-slide');  
            dots[slideIndex].classList.add('active-dot');
        }

        function currentSlide(n) {
            clearInterval(slideInterval);
            slideIndex = n;
            showSlides(slideIndex);
            startSlideInterval();
        }

        function startSlideInterval() {
            slideInterval = setInterval(() => {
                showSlides(slideIndex += 1);
            }, 5000); 
        }

        function setupSlideshow() {
            const slides = document.getElementsByClassName("testimonial-slide");
            const dotsContainer = document.getElementById("slideshowDots");

            // Generate dots
            for (let i = 0; i < slides.length; i++) {
                const dot = document.createElement('span');
                dot.className = 'dot';
                dot.onclick = () => currentSlide(i);
                dotsContainer.appendChild(dot);
            }

            // Start the slideshow
            showSlides(slideIndex);
            startSlideInterval();
        }


        // --- NEW: Scroll Animation Logic (Intersection Observer) ---
        function setupScrollAnimations() {
            // Only observe sections meant for scroll animation (added .animate-on-scroll class)
            const animatedElements = document.querySelectorAll('.animate-on-scroll');
            
            const observer = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                        observer.unobserve(entry.target); // Stop observing once visible
                    }
                });
            }, {
                root: null, // viewport
                rootMargin: '0px',
                threshold: 0.1 // 10% of the element must be visible
            });

            animatedElements.forEach(element => {
                observer.observe(element);
            });
        }
    </script> 
 
<script type="text/javascript" id="dcoder_script"><script>
        // --- Backendless Configuration ---
        const APPLICATION_ID = 'B669D83D-1513-4C1D-AF08-F7BF4C055542'; 
        const JS_API_KEY = 'B395986D-78B8-4ABF-987E-106A73B7A79A'; 
        const PACKAGES_TABLE = 'Packages';
        const BOOKINGS_TABLE = 'Bookings'; 
        
        // WhatsApp Configuration
        const WHATSAPP_NUMBER = '254791566724'; 

        try {
            Backendless.initApp(APPLICATION_ID, JS_API_KEY);
        } catch (e) {
            console.error("Failed to initialize Backendless:", e);
        }

        // --- Element Selectors ---
        const packagesList = document.getElementById('packages-list');
        const bookingModal = document.getElementById('booking-modal');
        const bookingForm = document.getElementById('booking-form');
        const modalTitle = document.getElementById('modal-title');
        const packageIdField = document.getElementById('booking-packageId');
        const packageNameField = document.getElementById('booking-packageName');
        const submitBookingBtn = document.getElementById('submit-booking-btn');
        const bookingStatus = document.getElementById('booking-status');
        
        // --- Helper Functions ---
        
        function displayStatus(type, message, sticky = false) { 
            bookingStatus.className = `status-message ${type}`;
            bookingStatus.style.display = 'block';
            bookingStatus.innerHTML = message;
            
            // Use a longer timeout (10s) for important success messages
            const timeout = sticky ? 10000 : 4000;

            setTimeout(() => {
                bookingStatus.style.display = 'none';
                closeModal();
            }, timeout);
        }

        window.openBookingModal = function(packageId, packageName) {
            modalTitle.textContent = `Finalize Booking: ${packageName}`;
            packageIdField.value = packageId;
            packageNameField.value = packageName;
            bookingForm.reset();
            bookingStatus.style.display = 'none';
            bookingModal.style.display = 'block';
        };
        
        window.consultViaWhatsApp = function(packageName) {
            const whatsappText = encodeURIComponent(`Hello Funpage Sports and Safaris, I am interested in the ${packageName} package and would like to chat now.`);
            const whatsappLink = `https://wa.me/${WHATSAPP_NUMBER}?text=${whatsappText}`;
            window.open(whatsappLink, '_blank');
        };

        window.closeModal = function() {
            bookingModal.style.display = 'none';
            bookingStatus.style.display = 'none'; 
        }

        // --- 1. Load Packages from Backendless ---
        async function loadPackages() {
            packagesList.innerHTML = '<p class="loading-text"><i class="fas fa-spinner fa-spin"></i> Loading packages...</p>';
            try {
                const queryBuilder = Backendless.DataQueryBuilder.create().setSortBy(['name ASC']); 
                const packages = await Backendless.Data.of(PACKAGES_TABLE).find(queryBuilder);
                
                if (!packages || packages.length === 0) {
                    packagesList.innerHTML = '<p class="loading-text">No packages are currently available. Check back soon!</p>';
                    return;
                }

                packagesList.innerHTML = packages.map((pkg, index) => `
                    <div class="package-card" style="transition-delay: ${index * 0.15}s;">
                        <div class="img-container">
                            <img src="${pkg.image}" alt="${pkg.name}" loading="lazy" style="opacity: 0;" onload="this.style.opacity=1;">
                        </div>
                        <div class="card-content">
                            <h3>${pkg.name}</h3>
                            <p class="info-text">${pkg.description.substring(0, 150)}${pkg.description.length > 150 ? '...' : ''}</p>
                            <div class="price">Starts from: Ksh ${pkg.price ? pkg.price.toLocaleString() : 'N/A'}</div>
                            <div class="card-actions">
                                <button 
                                    class="action-btn book-btn" 
                                    onclick="openBookingModal('${pkg.objectId}', '${pkg.name.replace(/'/g, "\\'")}')">
                                    <i class="fas fa-clipboard-list"></i> Book Now
                                </button>
                                <button 
                                    class="action-btn consult-btn" 
                                    onclick="consultViaWhatsApp('${pkg.name.replace(/'/g, "\\'")}')">
                                    <i class="fab fa-whatsapp"></i> Consult
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');
                
                document.querySelectorAll('.package-card').forEach(card => card.classList.add('visible'));

            } catch (error) {
                console.error("Package Fetch Error:", error);
                packagesList.innerHTML = '<p class="loading-text status-message error">❌ Failed to load packages. Please check your Backendless settings.</p>';
            }
        }

        // --- 2. Handle Booking Submission (UPDATED) ---
        bookingForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            submitBookingBtn.disabled = true;
            submitBookingBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Submitting...';
            bookingStatus.style.display = 'none';

            try {
                // CAPTURE M-PESA CODE FIELD
                const mpesaCodeInput = document.getElementById('mpesaCode').value.trim();
                
                const bookingData = {
                    clientName: document.getElementById('clientName').value,
                    phone: document.getElementById('phone').value,
                    date: new Date(document.getElementById('date').value).toISOString(), 
                    pax: parseInt(document.getElementById('pax').value),
                    packageId: packageIdField.value,
                    packageName: packageNameField.value,
                    // Save the entered code or 'N/A' to Backendless
                    mpesaCode: mpesaCodeInput || 'N/A', 
                    status: 'Pending' 
                };
                
                await Backendless.Data.of(BOOKINGS_TABLE).save(bookingData);
                
                // Construct dynamic success message
                let codeStatusMsg = mpesaCodeInput 
                    ? `**Your M-Pesa Code (${mpesaCodeInput}) has been noted.**` 
                    : `**ACTION: Please complete your M-Pesa payment and email the transaction code to us.**`;

                displayStatus('success', `
                    ✅ **Booking Submitted!**<br>
                    We've saved your booking for *${bookingData.packageName}*. <br>
                    ${codeStatusMsg}
                    
                    <div style="margin-top: 10px; padding: 10px; background-color: #fff; border-radius: 5px; font-size: 0.95rem;">
                       <strong>Payment via Equity Bank Paybill:</strong><br>
                       **Business No:** 247247<br>
                       **Account No:** 0791566724<br>
                    </div>

                    We will call you at ${bookingData.phone} shortly to confirm details and verify payment.
                `, true); // 'true' keeps the message visible longer for reading
                
            } catch (error) {
                console.error("Booking Submission Error:", error);
                displayStatus('error', `❌ Submission failed. Please ensure all fields are correct.`);
            } finally {
                submitBookingBtn.disabled = false;
                submitBookingBtn.innerHTML = '<i class="fas fa-check-circle"></i> Confirm and Submit Booking';
            }
        });

        // --- 3. Modal Event Listeners ---
        window.addEventListener('click', function(event) {
            if (event.target == bookingModal) {
                closeModal();
            }
        });

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', loadPackages);</script></body></html>
